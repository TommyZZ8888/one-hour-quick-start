### gzip压缩

压缩响应通常会显著减小传输数据的大小。但是，由于压缩发生在运行时，因此它还会增加相当大的处理开销，从而对性能产生负面影响。NGINX在将响应发送到客户端之前执行压缩，但如果后端服务器已经对内容进行了压缩，则nginx不会再压缩。
若要启用压缩，请在参数中包含 [gzip](https://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip) 指令。

```nginx
gzip on; 
gzip_types text/plain application/xml; 
gzip_min_length 1000;
```

默认情况下，NGINX仅使用压缩MIME类型是`text/html`的响应。若要使用其他 MIME 类型压缩响应，可以使用 [gzip_types](https://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip_types) 指令并列出其他类型。
若要指定压缩响应的最小长度，请使用 [gzip_min_length](https://nginx.org/en/docs/http/ngx_http_gzip_module.html#gzip_min_length) 指令。默认值为 20 个字节（此处调整为 1000)。

### sendfile

默认情况下，NGINX处理文件传输本身，并在发送之前将文件复制到缓冲区中。启用 [sendfile](https://nginx.org/en/docs/http/ngx_http_core_module.html#sendfile) 指令可消除将数据复制到缓冲区的步骤，直接将一个文件复制到另一个文件。
启用sendfile，类似Java中的零拷贝（zero copy）

```nginx
location /download {
  sendfile           on;
  tcp_nopush         on; 
  #... 
}
```

将 [tcp_nopush](https://nginx.org/en/docs/http/ngx_http_core_module.html#tcp_nopush) 指令与 [sendfile](https://nginx.org/en/docs/http/ngx_http_core_module.html#sendfile) 指令一起使用。这使NGINX能够在获得数据块后立即在一个数据包中发送HTTP响应标头。

### try_files

[try_files](https://nginx.org/en/docs/http/ngx_http_core_module.html#try_files)指令可用于检查指定的文件或目录是否存在;如果不存在，则重定向到指定位置。
如下，如果原始URI对应的文件不存在，NGINX将内部重定向到`/www/data/images/default.gif`

```nginx
server {
    root /www/data;

    location /images/ {
        try_files $uri /images/default.gif;
    }
}
```

最后一个参数也可以是状态代码（状态码之前需要加上等号）。
在下面的示例中，如果指令的所有参数都无法解析为现有文件或目录，则会返回404错误。

```nginx
location / {
    try_files $uri $uri/ $uri.html =404;
}
```

在下一个示例中，如果原始 URI 和附加尾随斜杠的 URI 都没有解析到现有文件或目录中，则请求将重定向到命名位置，该位置会将其传递到代理服务器。

```nginx
location / {
    try_files $uri $uri/ @backend;
}

location @backend {
    proxy_pass http://backend.example.com;
}
```

### error_page

为错误指定显示的页面。值可以包含变量。

```nginx
error_page 404             /404.html; 
error_page 500 502 503 504 /50x.html;
```

参考文档：
[https://docs.nginx.com/nginx/admin-guide/web-server/compression/](https://docs.nginx.com/nginx/admin-guide/web-server/compression/)<br>
[https://docs.nginx.com/nginx/admin-guide/web-server/serving-static-content/](https://docs.nginx.com/nginx/admin-guide/web-server/serving-static-content/)

